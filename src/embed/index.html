<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../../img/favicon.ico" />
    <title>Embed - RAG Systems</title>
    <link rel="stylesheet" href="../../css/theme.css" />
    <link rel="stylesheet" href="../../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../../assets/_mkdocstrings.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Embed";
        var mkdocs_page_input_path = "src/embed.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../.." class="icon icon-home"> RAG Systems
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../..">Home</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">Quickstart</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../quickstart/quickstart_setup/">Quickstart Setup</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../quickstart/developer_setup/">Local Developement Setup</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">How to</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../how_to/how_to_configure/">Configure RAG System</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../how_to/how_to_add_new_llm/">Add a New LLM</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../how_to/how_to_add_new_embedding_model/">Add a New Embedding Model</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../how_to/how_to_add_new_vector_store/">Add a New Vector Store</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../how_to/how_to_add_new_datasource/">Add a New Datasource</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Evaluation</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../evaluation/in_progress/">In progress</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Monitoring</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../monitoring/in_progress/">In progress</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Code Docs</span></p>
              <ul class="current">
                  <li class="toctree-l1"><a class="reference internal" href="../augment/">Augment</a>
                  </li>
                  <li class="toctree-l1 current"><a class="reference internal current" href="#">Embed</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#embed_1">Embed</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#src.embed">embed</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#src.embed.run">run</a>
    </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../evaluate/">Evaluate</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Augmentation</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" >Bootstrap</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" >Configuration</a>
    <ul>
                <li class="toctree-l4"><a class="reference internal" href="../augmentation/bootstrap/configuration/configuration/">Configuration</a>
                </li>
                <li class="toctree-l4"><a class="reference internal" href="../augmentation/bootstrap/configuration/temporal_domain_config/">Temporal_domain_config</a>
                </li>
                <li class="toctree-l4"><a class="reference internal" href="../augmentation/bootstrap/configuration/chainlit_configuration/">Chainlit_configuration</a>
                </li>
                <li class="toctree-l4"><a class="reference internal" >Components</a>
                </li>
                <li class="toctree-l4"><a class="reference internal" href="../augmentation/bootstrap/configuration/langfuse_configuration/">Langfuse_configuration</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../augmentation/bootstrap/initializer/">Initializer</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" >Components</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" >Postprocessors</a>
    <ul>
                <li class="toctree-l4"><a class="reference internal" >Colbert_rerank</a>
                </li>
                <li class="toctree-l4"><a class="reference internal" >Hybrid_filter</a>
                </li>
                <li class="toctree-l4"><a class="reference internal" href="../augmentation/components/postprocessors/registry/">Registry</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l3"><a class="reference internal" >Chat_engines</a>
    <ul>
                <li class="toctree-l4"><a class="reference internal" >Langfuse</a>
                </li>
                <li class="toctree-l4"><a class="reference internal" href="../augmentation/components/chat_engines/registry/">Registry</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l3"><a class="reference internal" >Retrievers</a>
    <ul>
                <li class="toctree-l4"><a class="reference internal" href="../augmentation/components/retrievers/query_rewriter/">Query_rewriter</a>
                </li>
                <li class="toctree-l4"><a class="reference internal" href="../augmentation/components/retrievers/query_rewriting_retriever/">Query_rewriting_retriever</a>
                </li>
                <li class="toctree-l4"><a class="reference internal" >Basic</a>
                </li>
                <li class="toctree-l4"><a class="reference internal" >Auto</a>
                </li>
                <li class="toctree-l4"><a class="reference internal" href="../augmentation/components/retrievers/registry/">Registry</a>
                </li>
                <li class="toctree-l4"><a class="reference internal" >Dynamic_temporal</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l3"><a class="reference internal" >Llms</a>
    <ul>
                <li class="toctree-l4"><a class="reference internal" href="../augmentation/components/llms/registry/">Registry</a>
                </li>
                <li class="toctree-l4"><a class="reference internal" >Lite_llm</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l3"><a class="reference internal" >Guardrails</a>
    <ul>
                <li class="toctree-l4"><a class="reference internal" href="../augmentation/components/guardrails/base_guardrails/">Base_guardrails</a>
                </li>
                <li class="toctree-l4"><a class="reference internal" >Basic</a>
                </li>
                <li class="toctree-l4"><a class="reference internal" href="../augmentation/components/guardrails/registry/">Registry</a>
                </li>
    </ul>
                </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" >Langfuse</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../augmentation/langfuse/client/">Client</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../augmentation/langfuse/dataset_service/">Dataset_service</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../augmentation/langfuse/prompt_service/">Prompt_service</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" >Chainlit</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../augmentation/chainlit/feedback_service/">Feedback_service</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../augmentation/chainlit/utils/">Utils</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../augmentation/chainlit/service/">Service</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../augmentation/chainlit/exceptions/">Exceptions</a>
                </li>
    </ul>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Core</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../core/logger/">Logger</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../core/base_factory/">Base_factory</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../core/configuration_retrievers/">Configuration_retrievers</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../core/base_configuration/">Base_configuration</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../core/base_initializer/">Base_initializer</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Embedding</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" >Vector_stores</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" >Qdrant</a>
    <ul>
                <li class="toctree-l4"><a class="reference internal" href="../embedding/vector_stores/qdrant/configuration/">Configuration</a>
                </li>
                <li class="toctree-l4"><a class="reference internal" href="../embedding/vector_stores/qdrant/vector_store/">Vector_store</a>
                </li>
                <li class="toctree-l4"><a class="reference internal" href="../embedding/vector_stores/qdrant/validator/">Validator</a>
                </li>
                <li class="toctree-l4"><a class="reference internal" href="../embedding/vector_stores/qdrant/client/">Client</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l3"><a class="reference internal" >Chroma</a>
    <ul>
                <li class="toctree-l4"><a class="reference internal" href="../embedding/vector_stores/chroma/configuration/">Configuration</a>
                </li>
                <li class="toctree-l4"><a class="reference internal" href="../embedding/vector_stores/chroma/vector_store/">Vector_store</a>
                </li>
                <li class="toctree-l4"><a class="reference internal" href="../embedding/vector_stores/chroma/validator/">Validator</a>
                </li>
                <li class="toctree-l4"><a class="reference internal" href="../embedding/vector_stores/chroma/client/">Client</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l3"><a class="reference internal" >Core</a>
    <ul>
                <li class="toctree-l4"><a class="reference internal" href="../embedding/vector_stores/core/validator/">Validator</a>
                </li>
                <li class="toctree-l4"><a class="reference internal" href="../embedding/vector_stores/core/exceptions/">Exceptions</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../embedding/vector_stores/registry/">Registry</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" >Pgvector</a>
    <ul>
                <li class="toctree-l4"><a class="reference internal" href="../embedding/vector_stores/pgvector/configuration/">Configuration</a>
                </li>
                <li class="toctree-l4"><a class="reference internal" href="../embedding/vector_stores/pgvector/vector_store/">Vector_store</a>
                </li>
                <li class="toctree-l4"><a class="reference internal" href="../embedding/vector_stores/pgvector/validator/">Validator</a>
                </li>
                <li class="toctree-l4"><a class="reference internal" href="../embedding/vector_stores/pgvector/client/">Client</a>
                </li>
    </ul>
                </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" >Bootstrap</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" >Configuration</a>
    <ul>
                <li class="toctree-l4"><a class="reference internal" href="../embedding/bootstrap/configuration/configuration/">Configuration</a>
                </li>
                <li class="toctree-l4"><a class="reference internal" href="../embedding/bootstrap/configuration/vector_store_configuration/">Vector_store_configuration</a>
                </li>
                <li class="toctree-l4"><a class="reference internal" href="../embedding/bootstrap/configuration/splitting_configuration/">Splitting_configuration</a>
                </li>
                <li class="toctree-l4"><a class="reference internal" href="../embedding/bootstrap/configuration/embedding_model_configuration/">Embedding_model_configuration</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../embedding/bootstrap/initializer/">Initializer</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" >Embedders</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../embedding/embedders/base_embedder/">Base_embedder</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" >Basic</a>
    <ul>
                <li class="toctree-l4"><a class="reference internal" href="../embedding/embedders/basic/embedder/">Embedder</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../embedding/embedders/registry/">Registry</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" >Orchestrators</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" >Basic</a>
    <ul>
                <li class="toctree-l4"><a class="reference internal" href="../embedding/orchestrators/basic/orchestrator/">Orchestrator</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../embedding/orchestrators/registry/">Registry</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../embedding/orchestrators/base_orchestrator/">Base_orchestrator</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" >Embedding_models</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" >Hugging_face</a>
    <ul>
                <li class="toctree-l4"><a class="reference internal" href="../embedding/embedding_models/hugging_face/configuration/">Configuration</a>
                </li>
                <li class="toctree-l4"><a class="reference internal" href="../embedding/embedding_models/hugging_face/embedding_model/">Embedding_model</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l3"><a class="reference internal" >Openai</a>
    <ul>
                <li class="toctree-l4"><a class="reference internal" href="../embedding/embedding_models/openai/configuration/">Configuration</a>
                </li>
                <li class="toctree-l4"><a class="reference internal" href="../embedding/embedding_models/openai/embedding_model/">Embedding_model</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l3"><a class="reference internal" >Voyage</a>
    <ul>
                <li class="toctree-l4"><a class="reference internal" href="../embedding/embedding_models/voyage/configuration/">Configuration</a>
                </li>
                <li class="toctree-l4"><a class="reference internal" href="../embedding/embedding_models/voyage/embedding_model/">Embedding_model</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../embedding/embedding_models/registry/">Registry</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" >Splitters</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" >Basic_markdown</a>
    <ul>
                <li class="toctree-l4"><a class="reference internal" href="../embedding/splitters/basic_markdown/configuration/">Configuration</a>
                </li>
                <li class="toctree-l4"><a class="reference internal" href="../embedding/splitters/basic_markdown/basic_markdown_splitter/">Basic_markdown_splitter</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../embedding/splitters/base_splitter/">Base_splitter</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../embedding/splitters/registry/">Registry</a>
                </li>
    </ul>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Evaluation</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" >Bootstrap</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" >Configuration</a>
    <ul>
                <li class="toctree-l4"><a class="reference internal" href="../evaluation/bootstrap/configuration/configuration/">Configuration</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../evaluation/bootstrap/initializer/">Initializer</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" >Evaluators</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../evaluation/evaluators/langfuse/">Langfuse</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../evaluation/evaluators/ragas/">Ragas</a>
                </li>
    </ul>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Extraction</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" >Bootstrap</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" >Configuration</a>
    <ul>
                <li class="toctree-l4"><a class="reference internal" href="../extraction/bootstrap/configuration/configuration/">Configuration</a>
                </li>
                <li class="toctree-l4"><a class="reference internal" href="../extraction/bootstrap/configuration/datasources/">Datasources</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../extraction/bootstrap/initializer/">Initializer</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" >Orchestrators</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../extraction/orchestrators/base_orchestator/">Base_orchestator</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" >Basic</a>
    <ul>
                <li class="toctree-l4"><a class="reference internal" href="../extraction/orchestrators/basic/orchestrator/">Orchestrator</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../extraction/orchestrators/registry/">Registry</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" >Datasources</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../extraction/datasources/pdf/">Pdf</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../extraction/datasources/confluence/">Confluence</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../extraction/datasources/bundestag/">Bundestag</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../extraction/datasources/core/">Core</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../extraction/datasources/notion/">Notion</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../extraction/datasources/registry/">Registry</a>
                </li>
    </ul>
                </li>
    </ul>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../..">RAG Systems</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../.." class="icon icon-home" aria-label="Docs"></a></li>
          <li class="breadcrumb-item">Code Docs</li>
      <li class="breadcrumb-item active">Embed</li>
    <li class="wy-breadcrumbs-aside">
          <a href="https://github.com/feld-m/rag_blueprint/edit/main/docs/src/embed.md" class="icon icon-github"> Edit on GitHub</a>
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="embed">Embed</h1>
<p>This module contains functionality related to the the <code>embed</code> script.</p>
<h2 id="embed_1">Embed</h2>


<div class="doc doc-object doc-module">



<a id="src.embed"></a>
    <div class="doc doc-contents first">

        <p>This script is the entry point for the embedding process.
It initializes the embedding orchestrator and starts the embedding workflow.
To run the script, execute the following command from the root directory of the project:</p>
<blockquote>
<p>python src/embed.py</p>
</blockquote>


<details class="optional-flags" open>
  <summary>Optional flags</summary>
  <p>--clear-collection: Clear/delete the vector store collection before embedding
--on-prem-config: Use on-premise configuration files
--env: Specify the environment (local, test, dev, prod)</p>
</details>









  <div class="doc doc-children">










<div class="doc doc-object doc-function">


<h2 id="src.embed.run" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">run</span><span class="p">(</span><span class="n">clear_collection</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="n">LoggerConfiguration</span><span class="o">.</span><span class="n">get_logger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">))</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

</h2>


    <div class="doc doc-contents ">

        <p>Execute the embedding process.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>clear_collection</code></b>
                  (<code><span title="bool">bool</span></code>, default:
                      <code>False</code>
)
              –
              <div class="doc-md-description">
                <p>If True, clear the collection before embedding</p>
              </div>
            </li>
            <li>
              <b><code>logger</code></b>
                  (<code><span title="logging.Logger">Logger</span></code>, default:
                      <code><span title="core.logger.LoggerConfiguration.get_logger">get_logger</span>(<span title="__name__">__name__</span>)</code>
)
              –
              <div class="doc-md-description">
                <p>Logger instance for logging messages</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/embed.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">run</span><span class="p">(</span>
    <span class="n">clear_collection</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">logger</span><span class="p">:</span> <span class="n">logging</span><span class="o">.</span><span class="n">Logger</span> <span class="o">=</span> <span class="n">LoggerConfiguration</span><span class="o">.</span><span class="n">get_logger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">),</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Execute the embedding process.</span>

<span class="sd">    Args:</span>
<span class="sd">        clear_collection: If True, clear the collection before embedding</span>
<span class="sd">        logger: Logger instance for logging messages</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">initializer</span> <span class="o">=</span> <span class="n">EmbeddingInitializer</span><span class="p">()</span>
    <span class="n">configuration</span> <span class="o">=</span> <span class="n">initializer</span><span class="o">.</span><span class="n">get_configuration</span><span class="p">()</span>

    <span class="n">vector_store_config</span> <span class="o">=</span> <span class="n">configuration</span><span class="o">.</span><span class="n">embedding</span><span class="o">.</span><span class="n">vector_store</span>

    <span class="c1"># Clear collection if requested</span>
    <span class="k">if</span> <span class="n">clear_collection</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Clearing collection &#39;</span><span class="si">{</span><span class="n">vector_store_config</span><span class="o">.</span><span class="n">collection_name</span><span class="si">}</span><span class="s2">&#39;...&quot;</span>
        <span class="p">)</span>
        <span class="n">vector_store</span> <span class="o">=</span> <span class="n">VectorStoreRegistry</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">vector_store_config</span><span class="o">.</span><span class="n">name</span><span class="p">)</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
            <span class="n">vector_store_config</span>
        <span class="p">)</span>
        <span class="n">vector_store</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Collection &#39;</span><span class="si">{</span><span class="n">vector_store_config</span><span class="o">.</span><span class="n">collection_name</span><span class="si">}</span><span class="s2">&#39; cleared successfully.&quot;</span>
        <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># Only validate if we didn&#39;t just clear (to avoid false positives)</span>
        <span class="n">validator</span> <span class="o">=</span> <span class="n">VectorStoreValidatorRegistry</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
            <span class="n">vector_store_config</span><span class="o">.</span><span class="n">name</span>
        <span class="p">)</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">vector_store_config</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">validator</span><span class="o">.</span><span class="n">validate</span><span class="p">()</span>
        <span class="k">except</span> <span class="n">CollectionExistsException</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Collection &#39;</span><span class="si">{</span><span class="n">e</span><span class="o">.</span><span class="n">collection_name</span><span class="si">}</span><span class="s2">&#39; already exists. &quot;</span>
                <span class="s2">&quot;Skipping embedding process. Use --clear-collection to override.&quot;</span>
            <span class="p">)</span>
            <span class="k">return</span>

    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Starting embedding process.&quot;</span><span class="p">)</span>
    <span class="n">orchestrator</span> <span class="o">=</span> <span class="n">EmbeddingOrchestratorRegistry</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
        <span class="n">configuration</span><span class="o">.</span><span class="n">embedding</span><span class="o">.</span><span class="n">orchestrator_name</span>
    <span class="p">)</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">configuration</span><span class="p">)</span>

    <span class="k">await</span> <span class="n">orchestrator</span><span class="o">.</span><span class="n">embed</span><span class="p">()</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Embedding process finished.&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../augment/" class="btn btn-neutral float-left" title="Augment"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../evaluate/" class="btn btn-neutral float-right" title="Evaluate">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
        <span>
          <a href="https://github.com/feld-m/rag_blueprint/" class="fa fa-github" style="color: #fcfcfc"> GitHub</a>
        </span>
    
    
      <span><a href="../augment/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../evaluate/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "../..";</script>
    <script src="../../js/theme_extra.js"></script>
    <script src="../../js/theme.js"></script>
      <script src="../../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
